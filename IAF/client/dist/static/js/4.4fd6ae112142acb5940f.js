webpackJsonp([4],{LKUL:function(t,a,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=n("xkf2"),o=n("UaxH"),s=n("P9l9");var i=n("TgwI").json2csv;n("SldL");var c={name:"Company",components:{CommonSearch:o.a,ChooseTags:e.a},data:function(){return{option:{},showChart:!1,currentPage:1,totalCompany:1e3,chooseArray0:void 0,chooseArray1:void 0,chooseArray2:void 0,chooseArray3:void 0,tags:[],chooseTagData:{},tableData:[],multipleSelection:[],batchCount:0,batchDownloadSection:500,isShowBatch:!1,companyData:[],companyVsData:[],companyVsSet:new Set,loading:{}}},computed:{vsCompany:function(){return{comId:Array.from(new Set(sessionStorage.getItem("companyId").split(","))).join(","),comName:this.companyVsData.join(",")}}},watch:{tags:function(){this.currentPage=1;for(var t=[],a=0;a<4;a++)t.push({flag:this["chooseArray"+a].flag,data:this["chooseArray"+a].data.map(function(t){return t.name})});var n={chooseParam:t,page:this.currentPage};this.getChooseCompanyData(n)}},methods:{handleCommand:function(t){1==+t?this.$router.push({name:"NewsLink"}):2==+t?this.$router.push({name:"CompanyLink"}):3==+t&&this.$router.push({name:"OrganizationLink"})},handleCountCompany:function(){this.showChart=!this.showChart},initChartOption:function(){var t,a=this;return(t=regeneratorRuntime.mark(function t(){var n,e,o,i,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=void 0,t.prev=1,t.next=4,Object(s.c)();case 4:n=t.sent;case 5:if(t.prev=5,200===n.data.code){t.next=8;break}throw new Error("Company.vue-initChartOption : data can not get");case 8:return e=n.data.data,o=e.tagArray,i=e.roundArray,c=e.result,a.option={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},toolbox:{top:20,feature:{saveAsImage:{show:!0}}},legend:{type:"scroll",data:function(){for(var t=[],a=1;a<=i.length;a++)t.push(i[a]);return t}()},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:o}],yAxis:[{type:"value",min:0,interval:500}],series:c},t.finish(5);case 11:case"end":return t.stop()}},t,a,[[1,,5,11]])}),function(){var a=t.apply(this,arguments);return new Promise(function(t,n){return function e(o,s){try{var i=a[o](s),c=i.value}catch(t){return void n(t)}if(!i.done)return Promise.resolve(c).then(function(t){e("next",t)},function(t){e("throw",t)});t(c)}("next")})})()},downloadCompany:function(){var t=this,a=this.multipleSelection.map(function(t){return t.com_name}),n=[];this.companyData.length>0&&(n=a.reduce(function(a,n){return a.concat(t.companyData.filter(function(t){return t.com_name===n}))},[])),console.log(n),i(n,!0),this.$refs.multipleTable.clearSelection()},downloadAllCompany:function(){this.totalCompany>this.batchDownloadSection?(this.batchCount=Math.ceil(this.totalCompany/this.batchDownloadSection),this.isShowBatch=!0):Object(s.a)({all:!0}).then(function(t){200===t.data.code&&i(t.data.data,!0)})},batchDownloadCompany:function(t,a){this.$message({showClose:!0,message:"下载数量过多, 请耐心等待!!!",type:"warning",center:!0}),Object(s.b)({head:t,tail:a}).then(function(t){200===t.data.code&&i(t.data.data,!0)})},handleSelectionChange:function(t){this.multipleSelection=t},handleEdit:function(t,a){var n=a.com_name,e=this.companyData.filter(function(t){return t.com_name===n})[0].com_id;this.$router.push({name:"CompanyDetailLink",params:{com_id:e}})},handleVs:function(t){if(this.companyVsSet.size>=4)this.$message({showClose:!0,message:"最多一次对比四家公司",type:"warning",center:!0});else{var a=t.com_name;this.companyVsSet.has(a)?this.$message({showClose:!0,message:"该公司已经加入对比列表,请重新选择",type:"warning",center:!0}):(this.companyVsSet.add(a),this.companyVsData=Array.from(this.companyVsSet),this.setStorage(),this.$refs[a].classList.add("hasclick"))}},setStorage:function(){var t=this,a=this.companyData.filter(function(a){for(var n=0;n<t.companyVsData.length;n++)if(a.com_name===t.companyVsData[n])return!0});if(sessionStorage.getItem("companyId")){var n=sessionStorage.getItem("companyId");n=n+","+a.map(function(t){return t.com_id}).join(","),sessionStorage.setItem("companyId",n)}else sessionStorage.setItem("companyId",a.map(function(t){return t.com_id}).join(","))},handleComp2Vs:function(){var t=this;this.$router.push({name:"VsCompanyLink",params:{data:this.vsCompany}}),this.companyVsData.forEach(function(a){t.$refs[a]&&t.$refs[a].classList.remove("hasclick")}),this.companyVsSet.clear(),this.companyVsData=[],sessionStorage.clear()},handleDeleteVsCompany:function(t){var a=this.companyVsData[t];this.$refs[a].classList.remove("hasclick"),this.companyVsData.splice(t,1),this.companyVsSet.delete(a)},handleCurrentChange:function(t){var a=this;this.companyVsData.forEach(function(t){a.$refs[t]&&a.$refs[t].classList.remove("hasclick")});var n=this.$refs.multipleTable;if(this.$refs=Object.assign({},{multipleTable:n}),0===this.tags.length)this.getCompanyData(t);else{for(var e=[],o=0;o<4;o++)e.push({flag:this["chooseArray"+o].flag,data:this["chooseArray"+o].data.map(function(t){return t.name})});var s={chooseParam:e,page:t};this.getChooseCompanyData(s)}document.documentElement.scrollTo(0,530)},handleChooseTag:function(t){var a=this;this.tags=t.data.tags,t.data.chooseData.forEach(function(t,n){var e=t.flag,o=t.choosedList;a["chooseArray"+n]={flag:e,data:o}})},loadingStart:function(){this.loading=this.$loading({lock:!0,text:"加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.3)"})},loadingClose:function(){this.loading.close()},getCompanyData:function(t,a){var n=this;this.loadingStart(),Object(s.a)({page:t}).then(function(t){200===t.data.code&&n.dealCompanyData(t.data.data,a)})},dealCompanyData:function(t,a){var e=this;this.companyData=t.company,this.tableData=t.company.map(function(t){var a=t.com_name,e=t.create_time,o=t.round,s=t.tag,i=t.invest_event&&t.invest_event[0]&&t.invest_event[0].sum;return{com_name:a,create_time:e,round:o,tag:s||"-",sum:i,image:n("+GsC")}}),this.$nextTick(function(){e.companyVsData.forEach(function(t){e.$refs[t]&&e.$refs[t].classList.add("hasclick")})}),a&&(this.totalCompany=t.totalCompany,this.chooseTagData={tags:[],data:[{tag:"行业",list:t.companyType,flag:"tag",choosedList:[]},{tag:"轮次",list:t.companyRound,flag:"round",choosedList:[]},{tag:"成立时间",list:t.companyTime,flag:"create_time",choosedList:[]},{tag:"状态",list:t.companyState,flag:"state",choosedList:[]}]}),this.loadingClose()},getChooseCompanyData:function(t){var a=this;this.loadingStart(),Object(s.r)(t).then(function(t){200===t.data.code&&a.dealChooseCompanyData(t.data.data)})},dealChooseCompanyData:function(t){this.companyData=t.result,this.tableData=t.result.map(function(t){return{com_name:t.com_name,create_time:t.create_time,round:t.round,tag:t.tag,sum:t.invest_event&&t.invest_event[0]&&t.invest_event[0].sum,image:n("+GsC")}}),this.totalCompany=t.totalLength,document.documentElement.scrollTo(0,530),this.loadingClose()}},mounted:function(){this.initChartOption()},created:function(){this.loadingStart(),this.getCompanyData(1,!0),document.documentElement.scrollTo(0,530)}},r={render:function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{attrs:{id:"company-box"}},[n("common-search"),t._v(" "),n("div",{staticClass:"company-nav"},[n("router-link",{attrs:{tag:"span",to:{name:"HomeLink"}}},[t._v("首页 > ")]),t._v(" "),n("el-dropdown",{on:{command:t.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[t._v("\n                公司"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown","show-timeout":"100","hide-timeout":"100"},slot:"dropdown"},[n("el-dropdown-item",{staticClass:"iconfont",attrs:{command:"1"}},[t._t("default",[t._v("")]),t._v(" 新闻\n                    ")],2),t._v(" "),n("el-dropdown-item",{staticClass:"iconfont",attrs:{command:"2"}},[t._t("default",[t._v("")]),t._v(" 公司\n                    ")],2),t._v(" "),n("el-dropdown-item",{staticClass:"iconfont",attrs:{command:"3"}},[t._t("default",[t._v("")]),t._v(" 机构\n                ")],2)],1)],1)],1),t._v(" "),n("choose-tags",{attrs:{chooseTagData:t.chooseTagData},on:{transferData:t.handleChooseTag}}),t._v(" "),n("div",{staticClass:"download-company-data"},[n("div",{staticClass:"download"},[t.multipleSelection.length>0?n("span",[t._v("已选择 "),n("strong",[t._v(t._s(t.multipleSelection.length))]),t._v(" 条")]):n("span",[t._v("共 "),n("strong",[t._v(t._s(t.totalCompany))]),t._v(" 条结果")]),t._v(" "),t.multipleSelection.length>0?n("button",{on:{click:t.downloadCompany}},[t._v("下载")]):n("button",{on:{click:t.downloadAllCompany}},[t._v("全部下载")])]),t._v(" "),n("div",{staticClass:"all-company"},[n("button",{on:{click:t.handleCountCompany}},[t._v("公司统计")])])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowBatch,expression:"isShowBatch"}],staticClass:"batch-download-box",on:{click:function(a){t.isShowBatch=!t.isShowBatch}}},[n("ul",{staticClass:"batch-download-content clear"},[n("p",[t._v("下载数量过多,请分批下载")]),t._v(" "),t._l(t.batchCount,function(a,e){return n("li",{on:{click:function(n){n.stopPropagation(),t.batchDownloadCompany((a-1)*t.batchDownloadSection,(a-1)*t.batchDownloadSection+t.batchDownloadSection)}}},[t._v("\n                "+t._s((a-1)*t.batchDownloadSection+1)+"~"+t._s((a-1)*t.batchDownloadSection+t.batchDownloadSection)+"\n            ")])})],2)]),t._v(" "),t.showChart?n("div",{staticClass:"count-company-box"},[n("div",{staticClass:"count-company"},[n("span",{staticClass:"count-company-delete iconfont",on:{click:function(a){t.showChart=!t.showChart}}},[t._v("")]),t._v(" "),n("v-chart",{attrs:{options:t.option}})],1)]):t._e(),t._v(" "),n("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),n("el-table-column",{attrs:{prop:"image",width:"60"},scopedSlots:t._u([{key:"default",fn:function(t){return[n("img",{attrs:{src:t.row.image,width:"40",height:"40"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"公司名",width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(t._s(a.row.com_name))]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"create_time",label:"时间",align:"left",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{prop:"tag",label:"行业"}}),t._v(" "),n("el-table-column",{attrs:{prop:"round",label:"轮次"}}),t._v(" "),n("el-table-column",{attrs:{label:"对比",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[n("span",{ref:a.row.com_name,staticClass:"iconfont company-compare",on:{click:function(n){return t.handleVs(a.row)}}},[t._v("")])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return t.handleEdit(a.$index,a.row)}}},[t._v("详情")])]}}])})],1),t._v(" "),n("div",{staticClass:"company-vs-box"},[n("p",{staticClass:"company-vs-title"},[t._v("公司比较")]),t._v(" "),n("ul",{staticClass:"company-vs-content"},[n("p",[t._v(t._s(t.companyVsData.length)+"/4")]),t._v(" "),t._l(t.companyVsData,function(a,e){return n("li",{key:e},[t._m(0,!0),t._v(" "),n("router-link",{attrs:{tag:"span",to:{name:"CompanyDetailLink",params:{company_name:a}}}},[t._v(t._s(a))]),t._v(" "),n("span",{staticClass:"company-vs-delete",on:{click:function(a){return t.handleDeleteVsCompany(e)}}},[t._v("×")])],1)}),t._v(" "),t.companyVsData.length>1?n("button",{staticClass:"company-vs-compare",on:{click:t.handleComp2Vs}},[t._v("\n                对比\n            ")]):t._e()],2)]),t._v(" "),n("div",{staticClass:"company-pagination-box clear"},[n("el-pagination",{staticClass:"company-pagination",attrs:{"current-page":t.currentPage,"page-size":20,layout:"prev, pager, next, jumper",total:t.totalCompany},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(a){t.currentPage=a},"update:current-page":function(a){t.currentPage=a}}})],1)],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"company-vs-img-box"},[a("img",{attrs:{src:n("+GsC"),alt:""}})])}]};var l=n("VU/8")(c,r,!1,function(t){n("wBtg")},"data-v-f79f2862",null);a.default=l.exports},TgwI:function(t,a){function n(t,a){return a?function(t){var a=[];if(t.invest_event&&t.invest_event.length>0)for(var n=0;n<t.invest_event.length;n++)a[n]={};else a=[{}];return a.forEach(function(a,n){for(var e in t)if("id"!==e&&"com_id"!==e&&"isdelete"!==e&&"ceo"!==e&&"event_id"!==e&&"news_id"!==e&&"org_id"!==e&&"mount"!==e&&"currency"!==e)if(Array.isArray(t[e])){var o=t[e][n];for(var s in o)"id"!==s&&"com_id"!==s&&"isdelete"!==s&&"ceo"!==s&&"event_id"!==s&&"news_id"!==s&&"org_id"!==s&&"mount"!==s&&"currency"!==s&&"investee"!==s&&(a["xyd_"+s]=o[s]||"-")}else a[e]=0===n?t[e]?t[e]:"-":""}),a}(t):function(t){var a=[];if(t.invest_event.length>0)for(var n=0;n<t.invest_event.length;n++)a[n]={};else a=[{}];return a.forEach(function(a,n){for(var e in t)if("create_time"!==e&&"publicCompany"!==e&&"invest_ThisYear"!==e&&"latelyInvest"!==e&&"id"!==e&&"org_id"!==e&&"org_url"!==e&&"isdelete"!==e&&"invest_ThisYear"!==e&&"latelyInvest"!==e)if(Array.isArray(t[e])){var o=t[e][n];for(var s in o)"tag"!==s&&"stock"!==s&&"news_link"!==s&&"id"!==s&&"org_id"!==s&&"belong"!==s&&"event_id"!==s&&"news_id"!==s&&"com_id"!==s&&"currency"!==s&&"mount"!==s&&"stock"!==s&&"investor"!==s&&(a["xyd_"+s]=o[s])}else a[e]=0===n?t[e]?t[e]:"-":""}),a}(t)}t.exports.json2csv=function(t,a){var e=void 0;e=a?"名称,简介,轮次,创建时间,状态,类型,投资轮次,投资时间,投资金额,投资方,投资占权,相关新闻":"名称,简介,机构类型,总投资数,轮次,日期,投资金额,最新投资",function(t,a){for(var n=a+"\n",e=0;e<t.length;e++){for(var o in t[e])n+=t[e][o]+"\t,";n+="\n"}var s="data:text/csv;charset=utf-8,\ufeff"+encodeURIComponent(n),i=document.createElement("a");i.href=s,i.download=(new Date).getTime()+".csv",document.body.appendChild(i),i.click(),document.body.removeChild(i)}(t.reduce(function(t,e){return t.concat(n(e,a))},[]),e)}},wBtg:function(t,a){}});